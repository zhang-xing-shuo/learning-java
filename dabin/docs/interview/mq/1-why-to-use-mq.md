## 为什么要使用消息队列？

主要有以下几点原因：

1、解**耦**。比如，用户下单后，订单系统需要通知库存系统，假如库存系统无法访问，则订单减库存将失败，从而导致订单操作失败。订单系统与库存系统耦合，这个时候如果使用消息队列，可以返回给用户成功，先把消息持久化，等库存系统恢复后，就可以正常消费减去库存了。

2、**异步**。将消息写入消息队列，非必要的业务逻辑以异步的方式运行，不影响主流程业务。

3、**削峰**。消费端慢慢的按照数据库能处理的并发量，从消息队列中慢慢拉取消息。在生产中，这个短暂的高峰期积压是允许的。比如秒杀活动，一般会因为流量过大，从而导致流量暴增，应用挂掉。这个时候加上消息队列，服务器接收到用户的请求后，首先写入消息队列，如果消息队列长度超过最大数量，则直接抛弃用户请求或跳转到错误页面。

总结一下，主要三点原因：**解耦、异步、削峰**。

## 那使用了消息队列会有什么缺点

- **系统可用性降低**。引入消息队列之后，如果消息队列挂了，可能会影响到业务系统的可用性。
- **系统复杂性增加**。加入了消息队列，要多考虑很多方面的问题，比如：一致性问题、如何保证消息不被重复消费、如何保证消息可靠性传输等。





---



[整理了200本计算机经典书籍，含下载方式](https://github.com/Tyson0314/java-books)

[Github疯传！谷歌师兄的LeetCode刷题笔记](https://topjavaer.cn/learning-resources/leetcode-note.html)

[大彬花了一周收集的简历模板](https://mp.weixin.qq.com/s/JEG11UnWdO_Wi8-Qib89VQ)

[学弟靠这本大厂面试手册，拿了字节跳动offer！](https://mp.weixin.qq.com/s/LVa4H5feXrjZL-DUtQQ0Yg)